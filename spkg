#!/bin/sh
pkgdir=$(cat ~/.config/spkg/destination)
if [ $1 = sync ]; then
 pkgurl=$2
 echo what name you want to call that script"("suggested: $(basename $pkgurl)")"?
 read pkgname
 cd $pkgdir
 wget -O $pkgname $pkgurl
 echo $(tput setaf 4) "making script executable" $(tput sgr0)
 chmod +x $pkgname
 echo $(tput setaf 4) "adding config file" $(tput sgr0)
 cd ~/.config/spkg/packages
 touch $pkgname
 echo $pkgurl > $pkgname
 echo $(tput setaf 4) "done" $(tput sgr0)
else
 if [ $1 = update ]; then
  pkgname=$2
  cd $pkgdir
  echo $(tput setaf 4) "removing old script" $(tput sgr0)
  rm $pkgname
  echo $(tput setaf 4) "getting script config" $(tput sgr0)
  cd ~/.config/spkg/packages
  pkgurl=$(cat $pkgname)
  cd $pkgdir
  wget -O $pkgname $pkgurl
  echo $(tput setaf 4) "making script executable" $(tput sgr0)
  chmod +x $pkgname
 else
  if [ $1 = remove ]; then
   pkgname=$2
   echo $(tput setaf 4) "removing script" $(tput sgr0)
   cd $pkgdir
   rm $pkgname
   echo $(tput setaf 4) "removing script config" $(tput sgr0)
   cd ~/.config/spkg/packages
   rm $pkgname
  else
   if [ $1 = list ]; then
    ls ~/.config/spkg/packages
   else
    if [ $1 = install ]; then
     pkgname=$2
     cd ~/.config/spkg/
     echo select repo "("options: $(ls repos)")"
     read pkginrepo
     wget -O repo $(cat repos/$pkginrepo)
     echo $(tput setaf 4) "executing repo index" $(tput sgr0)
     chmod +x repo
     bash repo $pkgname
     echo $(tput setaf 4) "removing repo index" $(tput sgr0)
     rm repo
    else
     if [ $1 = repo ]; then
      if [ $2 = add ]; then
       pkgrepo=$3
       cd ~/.config/spkg/repos
       echo what name you want to call that repo"("suggested: $(basename $pkgrepo)")"?
       read pkgreponame
       touch $pkgreponame
       echo $pkgrepo > $pkgreponame
       echo $(tput setaf 4) "added repo $pkgreponame with address $pkgrepo" $(tput sgr0)
      else
       if [ $2 = remove ]; then
        pkgrmrepo=$3
        cd ~/.config/spkg/repos
        rm $pkgrmrepo
       else
        if [ $2 = getlist ]; then
         echo current core repos:
         curl -s https://raw.githubusercontent.com/Pan00Pernicek/scriptpkg/master/repo-index
         echo add one by: spkg repo add repo-url
        else
         echo "$2 is not currently supported"
         curl -s https://raw.githubusercontent.com/Pan00Pernicek/scriptpkg/master/usage
        fi
       fi
      fi
     else
      echo "$1 is not currently supported"
      curl -s https://raw.githubusercontent.com/Pan00Pernicek/scriptpkg/master/usage
     fi
    fi
   fi
  fi
 fi
fi
